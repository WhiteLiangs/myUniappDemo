(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/msgInfo/msgInfo"],{"2c27":function(t,n,e){"use strict";(function(t){e("a2f3");o(e("66fd"));var n=o(e("d083"));function o(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=e,t(n.default)}).call(this,e("543d")["createPage"])},"47f9":function(t,n,e){"use strict";e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return r})),e.d(n,"a",(function(){return o}));var o={uIcon:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(e.bind(null,"19b9"))},uTag:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-tag/u-tag")]).then(e.bind(null,"7e9c"))},"u-Form":function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u--form/u--form")]).then(e.bind(null,"7907"))},uFormItem:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-form-item/u-form-item")]).then(e.bind(null,"ccfc"))},"u-Input":function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u--input/u--input")]).then(e.bind(null,"6815"))},uButton:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-button/u-button")]).then(e.bind(null,"e1bd"))},uActionSheet:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-action-sheet/u-action-sheet")]).then(e.bind(null,"98fb"))},uPopup:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(e.bind(null,"a8ea"))},uSubsection:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-subsection/u-subsection")]).then(e.bind(null,"06b5"))},uInput:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-input/u-input")]).then(e.bind(null,"a9dc"))}},i=function(){var t=this,n=t.$createElement;t._self._c;t._isMounted||(t.e0=function(n){t.showSex=!1})},r=[]},"8ab6":function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=e("26cb");function i(t,n){var e;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=r(t))||n&&t&&"number"===typeof t.length){e&&(t=e);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,u=!0,c=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return u=t.done,t},e:function(t){c=!0,s=t},f:function(){try{u||null==e.return||e.return()}finally{if(c)throw s}}}}function r(t,n){if(t){if("string"===typeof t)return s(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?s(t,n):void 0}}function s(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}function u(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function c(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?u(Object(e),!0).forEach((function(n){a(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):u(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function a(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var l=function(){e.e("components/citySelect/citysSelect").then(function(){return resolve(e("11f6"))}.bind(null,e)).catch(e.oe)},f={data:function(){return{showSex:!1,show:!1,show1:!1,value:!1,pjList:[],current1:0,list:[],list1:[],cityList:[],cityId:[],nickName:"",nickName1:"",avatarUrl:"",model1:{userInfo:{name:"",idCard:"",phone:"",sex:""}},points_id:[],points_name:[],actions:[{name:"男"},{name:"女"}],rules:{"userInfo.name":{type:"string",required:!0,message:"请填写姓名",trigger:["blur","change"]},"userInfo.phone":{type:"string",required:!0,message:"请填写手机号",trigger:["blur","change"]},"userInfo.idCard":{type:"string",required:!0,message:"身份证",trigger:["blur","change"]},"userInfo.sex":{type:"string",max:1,required:!0,message:"请选择男或女",trigger:["blur","change"]}}}},computed:c({},(0,o.mapState)("login",["userInfo"])),components:{citySelect:l},onLoad:function(){var t=this;this.userInfo.tags.length>0&&this.points_name.push(this.userInfo.tags[0].point_name),this.userInfo.cities.length>0&&this.userInfo.cities.forEach((function(n){t.cityList.push(n.address.toString()),t.cityId.push(n.city_codes.toString())}))},onShow:function(){var n=this;console.log(this.userInfo),this.$iBox.http("getUserInfo",{})({method:"post"}).then((function(e){n.model1.userInfo.name=e.data.name,n.model1.userInfo.phone=e.data.phone,n.model1.userInfo.sex="0"==e.data.gender?"男":"女",n.model1.userInfo.idCard=e.data.id_card,n.nickName1=e.data.nick_name,n.avatarUrl=e.data.avatar_url,t.hideLoading()})).catch((function(t){console.log("网络错误",t)}))},methods:c(c({},(0,o.mapActions)("login",["updateUserInfo"])),{},{editName:function(){this.show1=!0},submitName:function(){var n=this,e={nick_name:this.nickName,avatar_url:this.avatarUrl};this.$iBox.http("updateUserInfo",e)({method:"post"}).then((function(e){n.nickName1=n.nickName,n.show1=!1,t.showToast({icon:"none",title:"修改成功"})})).catch((function(t){console.log("网络错误",t)}))},editArv:function(){var n=this;t.chooseImage({success:function(e){var o=e.tempFilePaths;t.uploadFile({url:"https://www.kemanfang.net/data/public/index.php/wx/CommonData/uploadFile",filePath:o[0],name:"file",header:{authorization:n.userInfo.token},success:function(e){console.log(e.data);var o=JSON.parse(e.data);if(0==o.code){n.avatarUrl=o.data;var i={nick_name:n.nickName,avatar_url:n.avatarUrl};n.$iBox.http("updateUserInfo",i)({method:"post"}).then((function(n){t.showToast({icon:"none",title:"修改成功"})})).catch((function(t){console.log("网络错误",t)}))}}})}})},close:function(){this.show1=!1},closeCity:function(t){this.cityList.splice(t,1),this.cityId.splice(t,1),console.log(t,this.cityId,this.cityList)},regist:function(){console.log("dd"),t.navigateTo({url:"/pages/register/register"})},chooseSex:function(){this.showSex=!0},sexSelect:function(t){this.model1.userInfo.sex=t.name,this.$refs.form1.validateField("userInfo.sex")},submit:function(){var n=this;this.$refs.form1.validate().then((function(e){n.$iBox.http("completeInformation",{name:n.model1.userInfo.name,phone:n.model1.userInfo.phone,id_card:n.model1.userInfo.idCard})({method:"post"}).then((function(e){n.userInfo.name=n.model1.userInfo.name,n.userInfo.phone=n.model1.userInfo.phone,n.userInfo.id_card=n.model1.userInfo.idCard,n.updateUserInfo(n.userInfo),t.showToast({icon:"none",title:"提交成功"})})).catch((function(t){console.log("网络错误",t)}));var o=[];if(n.userInfo.cities.forEach((function(t){o.push(t.address)})),console.log(n.cityList,"jj"),0==n.userInfo.grade){if(0==n.cityList.length||0==n.points_name.length)return void t.showModal({title:"提示",content:"请选择区域和节点！",showCancel:!1,success:function(){}});n.$iBox.http("updateAuth",{province_code:n.cityId,point_ids:n.points_id})({method:"post"}).then((function(n){t.showModal({title:"提交成功",content:"请等待审核！",showCancel:!1,success:function(){t.navigateBack({})}})})).catch((function(t){console.log("网络错误",t)}))}else if(0!=n.userInfo.grade){if(o.sort().toString()==n.cityList.sort().toString()&&n.userInfo.tags[0].point_name==n.points_name[0])return;o.sort().toString()!=n.cityList.sort().toString()&&n.userInfo.tags[0].point_name==n.points_name[0]?n.$iBox.http("updateCityAuth",{province_code:n.cityId})({method:"post"}).then((function(n){t.showModal({title:"提交成功",content:"请等待审核！",showCancel:!1,success:function(){t.navigateBack({})}})})).catch((function(t){console.log("网络错误",t)})):(o.sort().toString()==n.cityList.sort().toString()&&n.userInfo.tags[0].point_name!=n.points_name[0]||n.$iBox.http("updateCityAuth",{province_code:n.cityId})({method:"post"}).then((function(t){})).catch((function(t){console.log("网络错误",t)})),n.$iBox.http("updatePointAuth",{point_ids:n.points_id})({method:"post"}).then((function(n){t.showModal({title:"提交成功",content:"请等待审核！",showCancel:!1,success:function(){t.navigateBack({})}})})).catch((function(t){console.log("网络错误",t)})))}})).catch((function(n){console.log(n,"error"),t.$u.toast("请完善信息")}))},chooseCity:function(){this.value=!0},choosePoints:function(){var t=this;this.show=!0,this.$iBox.http("getProjectPoint",{})({method:"post"}).then((function(n){t.list=n.data;var e=[];n.data.forEach((function(t){e.push(t.name)})),t.pjList=e,t.list1=t.list[0].points})).catch((function(t){console.log("网络错误",t)}))},change1:function(t){this.current1=t,this.list[t].points.length>0?this.list1=this.list[t].points:this.list1=[]},getCode:function(){t.navigateTo({url:"../login/login"})},sxProject:function(t){console.log(t),this.model1.userInfo.points="",this.points_name=[],this.points_id=[],this.points_id.push(t.id.toString()),this.points_name.push(t.name),this.show=!1},cityChange:function(t){var n,e="",o=i(t.citys);try{for(o.s();!(n=o.n()).done;){var r=n.value;e+=r}}catch(s){o.e(s)}finally{o.f()}this.cityList.includes(e)||(this.cityList.push(e),this.cityId.push(t.codes.toString())),this.value=!1}})};n.default=f}).call(this,e("543d")["default"])},b1e9:function(t,n,e){"use strict";var o=e("d2e0"),i=e.n(o);i.a},d083:function(t,n,e){"use strict";e.r(n);var o=e("47f9"),i=e("df95");for(var r in i)"default"!==r&&function(t){e.d(n,t,(function(){return i[t]}))}(r);e("b1e9");var s,u=e("f0c5"),c=Object(u["a"])(i["default"],o["b"],o["c"],!1,null,"2dceb3f0",null,!1,o["a"],s);n["default"]=c.exports},d2e0:function(t,n,e){},df95:function(t,n,e){"use strict";e.r(n);var o=e("8ab6"),i=e.n(o);for(var r in o)"default"!==r&&function(t){e.d(n,t,(function(){return o[t]}))}(r);n["default"]=i.a}},[["2c27","common/runtime","common/vendor"]]]);